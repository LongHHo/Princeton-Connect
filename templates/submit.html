<!DOCTYPE html>
<html>


  <head>
    <title> Princeton Connect Submit Form</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">

    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDQe5G3tqd5Vfwefn7w3Djrv1L1bmlKkTw&libraries=places, geometry"></script>
    <style>
      /* Set the size of the div element that contains the map */
      #map {
        height: 400px;  /* The height is 400 pixels */
        width: 100%;  /* The width is the width of the web page */
       }
    </style>

  </head>
  <body>
      <div id = "header">
          <h1>Princeton Connect</h1>
      </div>

      <!-- Top navigation -->
      <ul class="nav">
        <li><a class = "active" href="/templates/submit">Submit Entry</a></li>
        <li><a href="/">Home</a></li>
        <li><a href="/templates/lookup">Entry Look-Up</a></li>
      </ul>

    <h2>Search fields</h2>
    <hr />
    <form action="/templates/handleSubmit" method="get">
        <table style="width:20%">
          <tr>
            <td align = "right">
              <label for="netid">
                <span>Netid: </span>
              </label>
            </td>
            <td><input type="text" id="netid" name="netid" /></td>
          </tr>

          <tr>
            <td align = "right">
              <label for="name">
                <span>Name: </span>
              </label>
            </td>
            <td><input type="text" id="name" name="name" /></td>
          </tr>

          <tr>
            <td align = "right">
              <label for="email">
                <span>Email: </span>
              </label>
            </td>
            <td><input type="text" id="email" name="email" /></td>
          </tr>
          <tr>
            <td align = "right">
              <label for="phone">
                <span>Phone: </span>
              </label>
            </td>
            <td><input type="text" id="phone" name="phone" /></td>
          </tr>
          <tr>
              <td align = "right">
                <label for="description">
                  <span>Description: </span>
                </label>
              </td>
              <td><input type="text" id="description" name="description" /></td>
            </tr>
          <tr>
            <td align = "right">
              <label for="Address">
                <span>Address: </span>
              </label>
            </td>
            <td><input type="text" id="address" name="address" size="50" placeholder="Enter a location" autocomplete="on" runat="server"/> </td>
          </tr>

          <tr>
             <td></td>
            <td><input type="submit" value="Submit" /></td>
          </tr>
        </table>

        <input type="hidden" id="cityLat" name="cityLat" />
        <input type="hidden" id="cityLng" name="cityLng" />
      </form>

    <hr />



    <script>

    function initialize() {
      var input = document.getElementById('address');
      var autocomplete = new google.maps.places.Autocomplete(input);
      // changes whenever user selects new address in drop down
      google.maps.event.addListener(autocomplete, 'place_changed', function () {
                var place = autocomplete.getPlace();

                document.getElementById('cityLat').value = place.geometry.location.lat();
                document.getElementById('cityLng').value = place.geometry.location.lng();
            });
      }

    google.maps.event.addDomListener(window, 'load', initialize);

    </script>
    <div id="map"></div>
    <script>
      function stringBuilder(list){
        var st = "<p>" + "NETID: " + list[0] + "</p>" + "<p>" + "Name: " + list[1] + "</p>" + "<p>" + "Email: " + list[2] + "</p>" + "<p>" + "Phone: " + list[3] + "</p>" + "<p>" + "Description: " + list[4] + "</p>";
        return st;
      }
      function addMarker(coordinates, map, info){
        var marker = new google.maps.Marker({
          position: coordinates,
          map: map,
          // add tiger icon
        });

        var infowindow = new google.maps.InfoWindow({
          content: info
        });
        marker.addListener('click', function() {
          infowindow.open(map, marker);
          });
        console.log('success')
      }
      function initMap() {
        // Create a new StyledMapType object, passing it an array of styles,
        // and the name to be displayed on the map type control.
        var styledMapType = new google.maps.StyledMapType(
          [
            {
              "elementType": "geometry",
              "stylers": [
                {
                  "color": "#f5f5f5"
                }
              ]
            },
            {
              "elementType": "labels.icon",
              "stylers": [
                {
                  "visibility": "off"
                }
              ]
            },
            {
              "elementType": "labels.text.fill",
              "stylers": [
                {
                  "color": "#616161"
                }
              ]
            },
            {
              "elementType": "labels.text.stroke",
              "stylers": [
                {
                  "color": "#f5f5f5"
                }
              ]
            },
            {
              "featureType": "administrative.land_parcel",
              "elementType": "labels.text.fill",
              "stylers": [
                {
                  "color": "#bdbdbd"
                }
              ]
            },
            {
              "featureType": "poi",
              "elementType": "geometry",
              "stylers": [
                {
                  "color": "#eeeeee"
                }
              ]
            },
            {
              "featureType": "poi",
              "elementType": "labels.text.fill",
              "stylers": [
                {
                  "color": "#757575"
                }
              ]
            },
            {
              "featureType": "poi.park",
              "elementType": "geometry",
              "stylers": [
                {
                  "color": "#e5e5e5"
                }
              ]
            },
            {
              "featureType": "poi.park",
              "elementType": "labels.text.fill",
              "stylers": [
                {
                  "color": "#9e9e9e"
                }
              ]
            },
            {
              "featureType": "road",
              "elementType": "geometry",
              "stylers": [
                {
                  "color": "#ffffff"
                }
              ]
            },
            {
              "featureType": "road.arterial",
              "elementType": "labels.text.fill",
              "stylers": [
                {
                  "color": "#757575"
                }
              ]
            },
            {
              "featureType": "road.highway",
              "elementType": "geometry",
              "stylers": [
                {
                  "color": "#dadada"
                }
              ]
            },
            {
              "featureType": "road.highway",
              "elementType": "labels.text.fill",
              "stylers": [
                {
                  "color": "#616161"
                }
              ]
            },
            {
              "featureType": "road.local",
              "elementType": "labels.text.fill",
              "stylers": [
                {
                  "color": "#9e9e9e"
                }
              ]
            },
            {
              "featureType": "transit.line",
              "elementType": "geometry",
              "stylers": [
                {
                  "color": "#e5e5e5"
                }
              ]
            },
            {
              "featureType": "transit.station",
              "elementType": "geometry",
              "stylers": [
                {
                  "color": "#eeeeee"
                }
              ]
            },
            {
              "featureType": "water",
              "elementType": "geometry",
              "stylers": [
                {
                  "color": "#c9c9c9"
                }
              ]
            },
            {
              "featureType": "water",
              "elementType": "labels.text.fill",
              "stylers": [
                {
                  "color": "#9e9e9e"
                }
              ]
            }
          ],
            {name: 'Styled Map'});

        // Create a map object, and include the MapTypeId to add
        // to the map type control.
        var data= {{ markersData|tojson }};
        data = JSON.parse(data)

        var map = new google.maps.Map(document.getElementById('map'), {
          center: new google.maps.LatLng(40.349990 ,-74.658580),
          zoom: 5,
          mapTypeControlOptions: {
            mapTypeIds: ['roadmap', 'satellite', 'hybrid', 'terrain',
                    'styled_map']
          }
        });
        var info = ""
        for (i = 0; i < data.length; i++) {

          if (data[i].length > 5){
            info = stringBuilder(data[i]);
            addMarker({lat: data[i][5], lng: data[i][6]}, map, info);

          }
          }
        //Associate the styled map with the MapTypeId and set it to display.
        map.mapTypes.set('styled_map', styledMapType);
        map.setMapTypeId('styled_map');
      }
    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDQe5G3tqd5Vfwefn7w3Djrv1L1bmlKkTw&callback=initMap">
    </script>
  </body>
</html>
