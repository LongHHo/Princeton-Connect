<!DOCTYPE html>
<html>
  <head>
      <title> Princeton Connect</title>
      <meta charset="utf-8">
      <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <!-- <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDQe5G3tqd5Vfwefn7w3Djrv1L1bmlKkTw&libraries=places, geometry"></script> -->
      <style>
        /* Set the size of the div element that contains the map */
        body, html, #map {
          height: 100%;
          width: 100%;  /* The height is 400 pixels */
     /* The width is the width of the web page */
         }
      </style>
  </head>
  <body>
      <div id = "header">
          <h1>Princeton Connect</h1>
      </div>

      <!-- Top navigation -->
      <ul class="nav">
        <!--<li><a href="/templates/submit">Submit Entry</a></li> -->
        <li><button class = "open-button" onclick="openForm()">Submit/Edit Your Entry</button></li>
        <li><a class = "active" href="/">Home</a></li>
        <li><a href="/templates/lookup">Entry Look-Up</a></li>
      </ul>


      <div id = "content">
        <h3> Welcome to Princeton Connect!</h3>
        <p> Princeton Connect helps students find roommates for summer travels. If this is your first time on the site, go ahead and
          make an entry by clicking the 'Submit Entry' button, where you will enter where you will be for the summer. You can also search
          for already existing entries by clicking the 'Entry Look-Up' button.
        </p>
      </div>

      <div id="id01" class="modal">
        <span onclick="document.getElementById('id01').style.display='none'" class="close" title="Close Modal">&times;</span>
        <form class="modal-content" action="/templates/handleSubmit">
          <div class="container">
            <h1>Your Entry</h1>
            <p>Submit or edit your entry here</p>
            <p>If you already submitted an entry, it will display in the text boxes</p>
            <hr>
            <label for="netid"><b>netid</b></label>
            <input type="text" value="Enter netid" id="netid" name="netid" required>

            <label for="name"><b>Name</b></label>
            <input type="text" value="Enter name" id="name" name="name" required>

            <label for="email"><b>Email</b></label>
            <input type="text" value="Enter email" id="email" name="email" required>

            <label for="phone"><b>Phone</b></label>
            <input type="text" value="Enter phone" id="phone" name="phone" required>

            <label for="description"><b>Description</b></label>
            <textarea type="textarea" value="Whether for a roommate or a friend, tell us about yourself and what you're looking for"
            id="description" name="description" style="height:200px" required></textarea>

            <label for="address"><b>Address</b></label>
            <input type="text" value="Enter address" id="address" name="address" required>

            <button type="submit" class="btn">Submit</button>
            <button type="button" class="btn cancel" onclick="closeForm()">Close</button>
            <a href="/templates/delete"><button type="button" class="btn delete">Delete Entry</button></a>
          </div>
        </form>
      </div>

  

      <script src=
      "https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js">
            </script>


      <div id="map"></div>
      <script>
        function stringBuilder(list){
          var st = "<p>" + "NETID: " + list[0] + "</p>" + "<p>" + "Name: " + list[1] + "</p>" + "<p>" + "Email: " + list[2] + "</p>" + "<p>" + "Phone: " + list[3] + "</p>" + "<p>" + "Description: " + list[4] + "</p>";
          return st;
        }
        function addMarker(coordinates, map, info){
          var marker = new google.maps.Marker({
            position: coordinates,
            map: map,
            // add tiger icon
          });
  
          var infowindow = new google.maps.InfoWindow({
            content: info
          });
          marker.addListener('click', function() {
            infowindow.open(map, marker);
            });
          console.log('success')
        }
        function initMap() {
          // Create a new StyledMapType object, passing it an array of styles,
          // and the name to be displayed on the map type control.
          var styledMapType = new google.maps.StyledMapType(
            [
              {
                "elementType": "geometry",
                "stylers": [
                  {
                    "color": "#f5f5f5"
                  }
                ]
              },
              {
                "elementType": "labels.icon",
                "stylers": [
                  {
                    "visibility": "off"
                  }
                ]
              },
              {
                "elementType": "labels.text.fill",
                "stylers": [
                  {
                    "color": "#616161"
                  }
                ]
              },
              {
                "elementType": "labels.text.stroke",
                "stylers": [
                  {
                    "color": "#f5f5f5"
                  }
                ]
              },
              {
                "featureType": "administrative.land_parcel",
                "elementType": "labels.text.fill",
                "stylers": [
                  {
                    "color": "#bdbdbd"
                  }
                ]
              },
              {
                "featureType": "poi",
                "elementType": "geometry",
                "stylers": [
                  {
                    "color": "#eeeeee"
                  }
                ]
              },
              {
                "featureType": "poi",
                "elementType": "labels.text.fill",
                "stylers": [
                  {
                    "color": "#757575"
                  }
                ]
              },
              {
                "featureType": "poi.park",
                "elementType": "geometry",
                "stylers": [
                  {
                    "color": "#e5e5e5"
                  }
                ]
              },
              {
                "featureType": "poi.park",
                "elementType": "labels.text.fill",
                "stylers": [
                  {
                    "color": "#9e9e9e"
                  }
                ]
              },
              {
                "featureType": "road",
                "elementType": "geometry",
                "stylers": [
                  {
                    "color": "#ffffff"
                  }
                ]
              },
              {
                "featureType": "road.arterial",
                "elementType": "labels.text.fill",
                "stylers": [
                  {
                    "color": "#757575"
                  }
                ]
              },
              {
                "featureType": "road.highway",
                "elementType": "geometry",
                "stylers": [
                  {
                    "color": "#dadada"
                  }
                ]
              },
              {
                "featureType": "road.highway",
                "elementType": "labels.text.fill",
                "stylers": [
                  {
                    "color": "#616161"
                  }
                ]
              },
              {
                "featureType": "road.local",
                "elementType": "labels.text.fill",
                "stylers": [
                  {
                    "color": "#9e9e9e"
                  }
                ]
              },
              {
                "featureType": "transit.line",
                "elementType": "geometry",
                "stylers": [
                  {
                    "color": "#e5e5e5"
                  }
                ]
              },
              {
                "featureType": "transit.station",
                "elementType": "geometry",
                "stylers": [
                  {
                    "color": "#eeeeee"
                  }
                ]
              },
              {
                "featureType": "water",
                "elementType": "geometry",
                "stylers": [
                  {
                    "color": "#c9c9c9"
                  }
                ]
              },
              {
                "featureType": "water",
                "elementType": "labels.text.fill",
                "stylers": [
                  {
                    "color": "#9e9e9e"
                  }
                ]
              }
            ],
              {name: 'Styled Map'});
  
          // Create a map object, and include the MapTypeId to add
          // to the map type control.
          var data= {{ markersData|tojson }};
          data = JSON.parse(data)
  
          var map = new google.maps.Map(document.getElementById('map'), {
            center: new google.maps.LatLng(40.349990 ,-74.658580),
            zoom: 4,
            mapTypeControlOptions: {
              mapTypeIds: ['roadmap', 'satellite', 'hybrid', 'terrain',
                      'styled_map']
            }
          });
          var info = ""
          for (i = 0; i < data.length; i++) {
  
            if (data[i].length > 5){
              info = stringBuilder(data[i]);
              addMarker({lat: data[i][5], lng: data[i][6]}, map, info);
  
            }
            }
          //Associate the styled map with the MapTypeId and set it to display.
          map.mapTypes.set('styled_map', styledMapType);
          map.setMapTypeId('styled_map');
        }
      </script>
      <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDQe5G3tqd5Vfwefn7w3Djrv1L1bmlKkTw&libraries=places, geometry&callback=initMap">
      </script>

      <script>

        function openForm() {
          if ( {{netid | tojson}} != "") {
          document.getElementsByName('netid')[0].value= {{netid | tojson}};
          document.getElementsByName('name')[0].value= {{name | tojson}};
          document.getElementsByName('email')[0].value= {{email | tojson}};
          document.getElementsByName('phone')[0].value= {{phone | tojson}};
          document.getElementsByName('description')[0].value= {{description | tojson}};
          document.getElementsByName('address')[0].value= {{address | tojson}};
        }
        document.getElementById('id01').style.display='block';
        }

        function closeForm() {
          document.getElementById("id01").style.display = "none";
        }



        function initialize() {
        var input = document.getElementById('address');
        var autocomplete = new google.maps.places.Autocomplete(input);
        // changes whenever user selects new address in drop down
        google.maps.event.addListener(autocomplete, 'place_changed', function () {
                    var place = autocomplete.getPlace();
                });
          }

        google.maps.event.addDomListener(window, 'load', initialize);

        </script>

      

    </body>
</html>